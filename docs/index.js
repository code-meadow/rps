!function(){"use strict";var e=["https://the-coinsman-rps.ceagrass.workers.dev","https://rps.andrewgrass.workers.dev","https://the-burger-rps.ceagrass.workers.dev","https://yugiboy-rps.ceagrass.workers.dev"],r={},a=[],n=e=>null==e?e:e.key,t=function(e){this.tag[e.type](e)},l=(e,r,a,n,l)=>{"key"===r||("o"===r[0]&&"n"===r[1]?((e.tag||(e.tag={}))[r=r.slice(2)]=n)?a||e.addEventListener(r,t):e.removeEventListener(r,t):!l&&"list"!==r&&"form"!==r&&r in e?e[r]=null==n?"":n:null==n||!1===n?e.removeAttribute(r):e.setAttribute(r,n))},o=(e,r)=>{var a=e.props,n=3===e.tag?document.createTextNode(e.type):(r=r||"svg"===e.type)?document.createElementNS("http://www.w3.org/2000/svg",e.type,{is:a.is}):document.createElement(e.type,{is:a.is});for(var t in a)l(n,t,null,a[t],r);return e.children.map(e=>n.appendChild(o(e=c(e),r))),e.dom=n},s=(e,r,a,t,i)=>{if(a===t);else if(null!=a&&3===a.tag&&3===t.tag)a.type!==t.type&&(r.nodeValue=t.type);else if(null==a||a.type!==t.type)r=e.insertBefore(o(t=c(t),i),r),null!=a&&e.removeChild(a.dom);else{var y,d,u,m,p=a.props,h=t.props,v=a.children,w=t.children,g=0,S=0,f=v.length-1,P=w.length-1;for(var T in i=i||"svg"===t.type,{...p,...h})("value"===T||"selected"===T||"checked"===T?r[T]:p[T])!==h[T]&&l(r,T,p[T],h[T],i);for(;S<=P&&g<=f&&null!=(u=n(v[g]))&&u===n(w[S]);)s(r,v[g].dom,v[g++],w[S]=c(w[S++]),i);for(;S<=P&&g<=f&&null!=(u=n(v[f]))&&u===n(w[P]);)s(r,v[f].dom,v[f--],w[P]=c(w[P--]),i);if(g>f)for(;S<=P;)r.insertBefore(o(w[S]=c(w[S++]),i),(d=v[g])&&d.dom);else if(S>P)for(;g<=f;)r.removeChild(v[g++].dom);else{var b={},k={};for(T=g;T<=f;T++)null!=(u=v[T].key)&&(b[u]=v[T]);for(;S<=P;)u=n(d=v[g]),m=n(w[S]=c(w[S])),k[u]||null!=m&&m===n(v[g+1])?(null==u&&r.removeChild(d.dom),g++):null==m||1===a.tag?(null==u&&(s(r,d&&d.dom,d,w[S],i),S++),g++):(u===m?(s(r,d.dom,d,w[S],i),k[m]=!0,g++):null!=(y=b[m])?(s(r,r.insertBefore(y.dom,d&&d.dom),y,w[S],i),k[m]=!0):s(r,d&&d.dom,null,w[S],i),S++);for(;g<=f;)null==n(d=v[g++])&&r.removeChild(d.dom);for(var T in b)null==k[T]&&r.removeChild(b[T].dom)}}return t.dom=r},c=e=>!0!==e&&!1!==e&&e?e:d(""),i=e=>3===e.nodeType?d(e.nodeValue,e):y(e.nodeName.toLowerCase(),r,a.map.call(e.childNodes,i),e,null,1),y=(e,r,a,n,t,l)=>({type:e,props:r,children:a,dom:n,key:t,tag:l}),d=(e,n)=>y(e,r,a,n,null,3),u=(e,r,n)=>y(e,r,Array.isArray(n)?n:null==n?a:[n],null,r.key);const m={TitleScreen:Symbol("TitleScreen"),GameScreen:Symbol("GameScreen"),GameOverScreen:Symbol("GameOverScreen")},p={playerOneScore:0,playerTwoScore:0,roundsPlayed:0,tiesPlayed:0,result:"new-players",playerOneChoice:"nothing yet",playerTwoChoice:"nothing yet"},h={...p,playerOneBio:{},playerTwoBio:{},error:!1,money:100,gameNum:1,screen:m.TitleScreen};async function v(r){let a=e[Math.floor(Math.random()*e.length)],n=a;for(;a===n&&e.length>1;)n=e[Math.floor(Math.random()*e.length)];try{const[e,t]=await Promise.all([fetch(a+"/bio.json").then(e=>e.json()),fetch(n+"/bio.json").then(e=>e.json())]);return{...r,...p,players:[a,n],playerOneBio:e,playerTwoBio:t,error:!1}}catch{return{...r,...p,players:[null,null],playerOneBio:{},playerTwoBio:{},error:"Had trouble fetching the player. Please try again."}}}async function w(e,r){const a=await Promise.all([fetch(e.players[0]+"/rps").then(e=>e.text()),fetch(e.players[1]+"/rps").then(e=>e.text())]);let n=e.playerOneScore,t=e.playerTwoScore,l="",o=e.tiesPlayed,s=e.money;a[0]===a[1]?(l="Tie!",o++,2===r?s+=10:s-=5):!{rock:{scissors:!0},paper:{rock:!0},scissors:{paper:!0}}[a[0]][a[1]]?(l="Player Two Wins!",t++,1===r?s+=10:s-=5):(l="Player One Wins!",n++,0===r?s+=10:s-=5);let c={...e,roundsPlayed:e.roundsPlayed+1,tiesPlayed:o,result:l,playerOneChoice:a[0],playerTwoChoice:a[1],playerOneScore:n,playerTwoScore:t,money:s};return s<=0?async function(e){return g(e,m.GameOverScreen)}(c):c.roundsPlayed>=10?async function(e){return v({...e,gameNum:e.gameNum+1})}(c):c}async function g(e,r){return{...e,screen:r}}async function S(e){return v({...e,money:100,gameNum:1})}class f{static Screen(e){return console.log(e),e.screen===m.TitleScreen?f.TitleScreen(e):e.screen===m.GameScreen?f.GameScreen(e):e.screen===m.GameOverScreen?f.GameOverScreen(e):u("div",{class:"error"},d("Unknown screen: "+e.screen))}static TitleScreen(e){return u("div",{class:"TitleScreen"},[u("button",{onclick:async()=>P(await g(await S(e),m.GameScreen))},d("Start game"))])}static GameScreen(e){return u("div",{class:"GameScreen"},[f.PlayerArea(e),u("div",{class:"RoundsArea"},[u("p",{},d("Game "+e.gameNum)),u("p",{},d(10-e.roundsPlayed+" rounds left! There were "+e.tiesPlayed+" ties."))]),u("div",{class:"ScoreArea"},d([e.playerOneScore,e.playerTwoScore].join("-"))),u("div",{class:"ResultArea"},d("Player One chose "+e.playerOneChoice+". Player Two chose "+e.playerTwoChoice+". "+e.result)),u("div",{class:"StatsArea"},[u("p",{},d("You have $"+e.money))]),u("div",{class:"PlayArea"},[u("button",{class:"bet player-one",onclick:async()=>P(await w(e,0))},d("I bet player one will win!")),u("button",{class:"bet player-two",onclick:async()=>P(await w(e,1))},d("No way! I'm betting on player two~")),u("button",{class:"bet neither",onclick:async()=>P(await w(e,2))},d("Um, actually! I foresee a tie **")),u("button",{class:"new-players secondary",onclick:async()=>P(await v({...e,money:e.money-20}))},d("Reset with New Players (-$20)"))])])}static GameOverScreen(e){return u("div",{class:"GameOverScreen"},[u("p",{},d("Game over! You survived "+(e.gameNum-1)+" games.")),u("button",{onclick:async()=>P(await g(await S(e),m.GameScreen))},d("Play Again")),u("button",{class:"secondary",onclick:async()=>P(await g(e,m.TitleScreen))},d("Quit"))])}static Header(){return u("div",{class:"Header"},[u("h1",{},d("Rock! Paper! Scissors!"))])}static PlayerArea(e){return e.error?u("div",{class:"PlayerArea error"},d(e.error)):u("div",{class:"PlayerArea"},[f.Player(e.playerOneBio),f.Player(e.playerTwoBio)])}static Player(e){return u("div",{class:"PlayerArea-Player"},[u("h2",{class:"Player-Name"},d(e.name)),u("img",{class:"Player-Image",alt:e.name,src:e.image_url}),u("p",{class:"Player-Description"},d(e.strategy))])}}const P=e=>((e,r)=>((e=s(e.parentNode,e,e.v||i(e),r)).v=r,e))(document.getElementById("app"),u("main",{},[f.Header(),f.Screen(e)]));document.addEventListener("DOMContentLoaded",async()=>{P(await S(h))})}();
